@page
@using colafix_pwa.Model
@model colafix_pwa.Pages.PedidosRelatorioModel
@{
    var pedidosRelatorio = (PedidosRelatorio)ViewData["PedidosRelatorio"];
    var classe = "col-12 padrao";
}

<div class="row pt-6">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <div class="col-sm-12">
                    Totais de Pedidos
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-sm-12">
                        <b>Pendente:</b> R$ @pedidosRelatorio.TotalPendente
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Análise:</b> R$ @pedidosRelatorio.TotalAnalise
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Crédito:</b> R$ @pedidosRelatorio.TotalCredito
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Liquidado:</b> R$ @pedidosRelatorio.TotalLiquidado
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Reprovado:</b> R$ @pedidosRelatorio.TotalReprovado
                    </div>
                </div>
            </div>
            @*<div class="card-footer">
                    <button class="btn waves-effect waves-light" type="button" onclick="AddRemoveCli(@cliente.Id, '@cliente.Nome')">Selecionar</button>
                </div>*@
        </div>
    </div>
</div>

<div class='row' style='margin-bottom:0'>
    <div class='col-12'>
        <label class="label-select" style="color: var(--theme-color)" for="filtro"><b>Selecione Situação</b></label>
        <select id="filtro" onchange="filtrar(this)"></select>
        <span class="highlight"></span>
        <span class="bar"></span>
    </div>
</div>


@*<div class="input-field col s12">
    <select id="filtro" onchange="filtrar(this)">
        <option value="" disabled selected>Selecione Situação</option>
        <option value="1">Pendente</option>
        <option value="2">Análise</option>
        <option value="3">Crédito</option>
        <option value="4">Liquidado</option>
        <option value="5">Reprovado</option>
    </select>
</div>*@




<div class="row pt-6">
    @foreach (var pedido in pedidosRelatorio.PedidosAapp)
    {


        classe += pedido.Situacao == "PENDENTE"
            ? " pendente"
            : pedido.Situacao == "ANALISE"
                ? " analise"
                : pedido.Situacao == "CREDITO"
                ? " credito"
                : pedido.Situacao == "LIQUIDADO" ? " liquidado" : "reprovado";


    <div class="@classe" style="display:none">
        <div class="card">
            <div class="card-header">
                <div class="col-sm-12">
                    <b>Pedido:</b> @pedido.Id <b>Emissão:</b> @pedido.DataEmissao
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-sm-12">
                        <b>Cliente:</b> @pedido.NomeCli
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Obs:</b> @pedido.Obs
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Situação:</b> @pedido.Situacao
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <b>Total do Pedido:</b> @string.Format("{0:C}", pedido.VlrTot)
                    </div>
                </div>
                <div class="card-footer">
                    <button class="btn waves-effect waves-light" type="button" onclick="mostraDetalhe(@pedido.Id)">Detalhes do Pedido</button>
                </div>

                @*<div class="row">
                    <div class="col-sm-12">
                        @pedido.PedidoItemApp[0].CodProd - @pedido.PedidoItemApp[0].NomeProd <br>
                        Qtde    : @pedido.PedidoItemApp[0].QtdePed<br />
                        Valor R$: @pedido.PedidoItemApp[0].Valor
                    </div>
                </div>*@
            </div>
        </div>
    </div>
        classe = "col-12 padrao";
    }
</div>

@section Scripts
{
    <script>
        carregaSituacao();
        $(document).ready(function () {
            $('.collapsible').collapsible();
            ShowCurrentCli();

            $(document).ready(function () {
                $('#filtro').formSelect();
            });
        });

        function filtrar(obj) {
        var divs = document.getElementsByClassName('padrao');
        console.log(divs);
        for (var i = 0; i < divs.length; i++) {
            divs[i].style.display = "none";
        }
        var e = document.getElementById(obj.id);
        var fil = e.options[e.selectedIndex].value;
        if (fil == 1) {
            var divs = document.getElementsByClassName('pendente');
            console.log(divs);
            for (var i = 0; i < divs.length; i++) {
                divs[i].style.display = "block";
            }
        } else if (fil == 2) {
            var divs = document.getElementsByClassName('analise');
            console.log(divs);
            for (var i = 0; i < divs.length; i++) {
                divs[i].style.display = "block";
            }
        } else if (fil == 3) {
            var divs = document.getElementsByClassName('credito');
            console.log(divs);
            for (var i = 0; i < divs.length; i++) {
                divs[i].style.display = "block";
            }
        } else if (fil == 4) {
            var divs = document.getElementsByClassName('liquidado');
            console.log(divs);
            for (var i = 0; i < divs.length; i++) {
                divs[i].style.display = "block";
            }
        } else if (fil == 5) {
            var divs = document.getElementsByClassName('reprovado');
            console.log(divs);
            for (var i = 0; i < divs.length; i++) {
                divs[i].style.display = "block";
            }
        }

       }

        function mostraDetalhe(id) {
            RedirectAction("/PedidoDetalhe/?id=".concat(id));
        }

    function carregaSituacao() {
            const lstSituacao = document.getElementById('filtro');

            const option = document.createElement("option");
            option.value = "1";
            option.innerHTML = "Pendente"
            lstSituacao.appendChild(option);

            const option2 = document.createElement("option");
            option2.value = "2";
            option2.innerHTML = "Análise"
            lstSituacao.appendChild(option2);

            const option3 = document.createElement("option");
            option3.value = "3";
            option3.innerHTML = "Crédito"
            lstSituacao.appendChild(option3);

            const option4 = document.createElement("option");
            option4.value = "4";
            option4.innerHTML = "Liquidado"
            lstSituacao.appendChild(option4);

            const option5 = document.createElement("option");
            option5.value = "5";
            option5.innerHTML = "Reprovado"
            lstSituacao.appendChild(option4);

            console.log(lstSituacao);


        }

    </script>
}
